# ==========================================
# ğŸ›¡ï¸ Trade Guardian Config (V4.4 Final Closed Loop)
# ==========================================

paths:
  tickers_csv: "data/tickers.csv"
  cache_dir: "cache"

scan:
  throttle_sec: 0.5
  contract_type: "ALL"

rules:
  # ç»“æ„ä¼˜åŠ¿é—¨æ§›
  min_edge_short_base: 1.05

  # [Long Gamma] ç¡¬æ€§é£æ§å‚æ•°
  lg_min_dte_etf: 7
  lg_min_dte_stock: 10
  lg_max_spread_pct: 0.08

  # [Risk Caps]
  gamma_soft_cap: 0.24
  gamma_hard_cap: 0.32

  # [Pin Risk]
  pin_risk_cap: 0.25
  pin_risk_coeff: 0.3

  # [Time Stop]
  lg_time_stop_min: 90
  lg_no_move_frac: 0.25

  # [Momentum]
  lg_allowed_dna_exec: ["PULSE"]
  lg_allowed_dna_limit: ["TREND"]
  lg_dna_quiet_action: "WAIT"

  # ==========================================
  # [Anchor] ç”¨äºç»“æ„è¯„ä¼°ï¼ˆEdge/Shapeï¼‰çš„â€œé”šç‚¹â€
  # ==========================================
  anchor_min_dte: 20
  anchor_max_dte: 45
  anchor_fallback_max_dte: 90
  anchor_target_dte: 35
  anchor_lambda_dist: 0.35
  anchor_prefer_monthly: true   # ä¸»çª—å£å†…ä¼˜å…ˆç¬¬ä¸‰å‘¨äº”ï¼ˆé¿å… 59DTE åœ¨ fallback å¸èµ°ä¸€åˆ‡ï¼‰

  # ------------------------------------------
  # [Compatibility] å…¼å®¹æ—§å­—æ®µï¼šmonth_* = anchor_*
  # ï¼ˆå¦‚æœä½ å·²æŠŠä»£ç æ”¹æˆè¯» anchor_*ï¼Œè¿™æ®µå¯ä»¥åˆ ï¼‰
  # ------------------------------------------
  month_min_dte: 20
  month_max_dte: 45
  month_fallback_max_dte: 90
  month_target_dte: 35
  month_lambda_dist: 0.35
  month_prefer_monthly: true

  # ==========================================
  # [Diagonal Long] ç”¨äºâ€œå¯¹è§’çº¿é•¿è…¿â€çš„çœŸå® long expï¼ˆäº¤æ˜“ç”¨ï¼‰
  # ==========================================
  diag_long_min_dte: 45
  diag_long_max_dte: 75
  diag_long_fallback_max_dte: 120
  diag_long_target_dte: 60
  diag_long_lambda_dist: 0.25
  diag_long_prefer_monthly: true
  diag_long_min_gap_vs_short: 20   # long_dte è‡³å°‘æ¯” short_dte å¤š 20 å¤©



policy:
  base_rank: 1
  min_dte: 1
  probe_count: 3

strategies:
  diagonal:
    use_rank_0_for_short: true
    short_min_dte: 1
    short_max_dte: 14
  
  hv_calendar:
    hv_rules:
      hv_low_rank: 20.0
      hv_mid_rank: 50.0
      hv_high_rank: 70.0
      hv_low_bonus: 10
      hv_mid_bonus: 4
      hv_high_penalty: -4
      hv_extreme_penalty: -10